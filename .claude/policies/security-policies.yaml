# Security and Compliance Policies
version: 4.0.0

authentication:
  method: oauth2
  provider: corporate_sso
  mfa_required: true
  token_lifetime: 8h

authorization:
  rbac:
    enabled: true
    roles:
      - name: admin
        permissions: ['*']
      - name: developer
        permissions: ['read', 'write', 'execute']
      - name: analyst
        permissions: ['read', 'execute']
      - name: viewer
        permissions: ['read']

  agent_access:
    default: authenticated_users
    restricted:
      - security-auditor: [admin, security_team]
      - deployment-engineer: [admin, devops_team]
      - database-admin: [admin, dba_team]

encryption:
  at_rest:
    enabled: true
    algorithm: AES-256-GCM
    key_rotation: monthly

  in_transit:
    enabled: true
    protocol: TLS 1.3
    cipher_suites: [TLS_AES_256_GCM_SHA384]

  secrets_management:
    provider: hashicorp_vault
    path: /agents/secrets
    auto_rotation: true

compliance:
  frameworks:
    - SOC2_Type2
    - GDPR
    - HIPAA
    - ISO27001

  data_governance:
    classification:
      - public
      - internal
      - confidential
      - restricted

    retention:
      default: 90_days
      audit_logs: 7_years
      financial: 10_years

    deletion:
      soft_delete: true
      hard_delete_after: 30_days

  audit:
    enabled: true
    events:
      - agent_invocation
      - data_access
      - configuration_change
      - error_occurrence

    storage:
      immutable: true
      encrypted: true
      retention: 7_years

network_security:
  firewall:
    default_action: deny
    allowed_sources:
      - internal_network
      - vpn_gateway

  network_policies:
    agent_to_agent: allow
    external_access: restricted
    egress_filtering: enabled

  ddos_protection:
    enabled: true
    provider: cloudflare
    rate_limiting: 1000_req_per_minute
